(function(){"use strict";var n={enumerable:!1,configurable:!0,writable:!0},t=this.Object.defineProperty,e=function(n){var t=JSON.stringify(n,function(n,t){return"function"==typeof t?t.toString():t},2);return"\n>>> "+String(t).replace(/\n/g,"\n    ")},r=function(n){return void 0!==n},o=function(n){return Array.isArray(n)},i=function(n){return"function"==typeof n},a=function(n){return"string"==typeof n},u=function(n){return"number"==typeof n},c=function(n){return!!n&&n.constructor===Object},d=function(n){return!!(n&&n.tagName&&n.nodeName&&n.ownerDocument&&n.removeAttribute)},l=function(n){if(void 0!==n)return JSON.parse(JSON.stringify(n))},s=function(n,t){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(!n)throw new Error("@okwolo."+t+o.map(e).join(""))},f=function(){var n=[],t=function(){var t=n[0];t&&t()};return{add:function(e){n.push(e),1===n.length&&t()},done:function(){n.shift(),t()}}},b=function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return function(n,t){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!t||e.length!==t);r=!0);}catch(n){o=!0,i=n}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),this.list=n;for(var t="root",e=0;e<this.list.length;++e){t+=" -> ";var r=this.list[e].tag;t+=r.substr(0,16),r.length>16&&(t+="...")}this.formatted=t},v=h.prototype,p=function(){for(var n=arguments.length,t=Array(n),e=0;e<n;e++)t[e]=arguments[e];return t.map(function(n){return a(n)?n:o(n)?p.apply(void 0,function(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}(n)):c(n)?p(Object.keys(n).map(function(t){return n[t]&&t})):void 0}).filter(Boolean).join(" ")},g=function(n,t){y.browser&&(r(t)||(s("undefined"!=typeof window,"app : must be run in a browser environment"),t=window));var e,o,u,d=function(){},l=function(){return d.apply(void 0,arguments)};return Object.assign(l,(e={},o={},{on:function(n,t){s(a(n),"on : handler type is not a string",n),s(i(t),"on : handler is not a function",t),r(e[n])||(e[n]=[]),e[n].push(t)},send:u=function(n){for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];s(a(n),"send : event type is not a string",n);var u=e[n];if(r(u))for(var c=0;c<u.length;++c)u[c].apply(u,o)},use:function(n){for(var t=arguments.length,e=Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];if(a(n))u.apply(void 0,["blob."+n].concat(e));else{s(c(n),"use : blob is not an object",n);var d=n.name;if(r(d)){if(s(a(d),"utils.bus : blob name is not a string",d),r(o[d]))return;o[d]=!0}Object.keys(n).forEach(function(t){u("blob."+t,n[t])})}}})),l.on("blob.api",function(n,t){s(c(n),"on.blob.api : additional api is not an object",n),Object.keys(n).forEach(function(e){t||s(!l[e],'on.blob.api : cannot add key "'+e+'" because it is already defined'),l[e]=n[e]})}),l.on("blob.primary",function(n){s(i(n),"on.blob.primary : primary is not a function",n),d=n}),w.forEach(function(n){n({on:l.on,send:l.send},t)}),r(n)&&l.use("target",n),l},y={kit:"lite",browser:!0};n.value=function(n){return void 0===n?this.formatted:this.formatted+" -> {{"+n+"}}"},t(v,"f",n),n.value=function(n,t){return new h(this.list.concat([{tag:n,key:t}]))},t(v,"add",n),n.value=function(n,t){return this.list.push({tag:n,key:t}),this},t(v,"addUnsafe",n),n.value=function(){return new h(this.list.slice())},t(v,"copy",n),n.value=function(){var n=[];if(this.list.length<2)return[];for(var t=1;t<this.list.length;++t)n.push(this.list[t].key);return n},t(v,"keys",n);var m=/:\w+/g,w=[function(n){var t=n.on,e=n.send,r={},o=r,a=void 0;t("state",function(n){o=n}),t("blob.handler",function(n){s(i(n),"on.blob.handler : handler generator is not a function",n);var t=n(function(){return o});s(i(t),"on.blob.handler : handler from generator is not a function",t),a=t}),e("blob.handler",function(){return function(n){e("state",n)}});e("blob.api",{setState:function(n){var t=i(n)?n(l(o)):n;a(t)},getState:function(){return s(o!==r,"state.getState : cannot get state before it has been set"),l(o)}})},function(n){var t=n.on,e=n.send,o=void 0,a=void 0,u=void 0,c=void 0,d=void 0,l=void 0,b=void 0;t("blob.target",function(n){o=n,e("update",!0)}),t("blob.builder",function(n){s(i(n),"on.blob.builder : builder is not a function",n),a=n,e("update",!1)}),t("blob.draw",function(n){s(i(n),"on.blob.draw : new draw is not a function",n),c=n,e("update",!0)}),t("blob.update",function(n){s(i(n),"on.blob.update : new target updater is not a function",n),d=n,e("update",!1)}),t("blob.build",function(n){s(i(n),"on.blob.build : new build is not a function",n),u=n,e("update",!1)}),t("state",function(n){s(r(n),"on.state : new state is not defined",n),b=n,e("update",!1)});var h=!1,v=!1,p=null;t("update",function(n){if(!v){if(!(r(o)&&r(a)&&r(b)))return void(p||(p=setTimeout(function(){var n={builder:a,state:b,target:o};Object.keys(n).forEach(function(t){n[t]=n[t]?"ok":"waiting"}),s(v,"view : still waiting to draw after "+Math.round(3)+"s",n)},3e3)));v=!0}var t=f();if(n||!h)return l=c(o,u(a(b),t)),h=!0,void t.done();l=d(o,u(a(b),t),[],l),t.done()}),t("sync",function(n,t,e){s(h,"view.sync : cannot sync component before app has drawn"),l=d(o,t,n,l,e)}),e("blob.api",{update:function(){console.warn("@okwolo.update : function will be deprecated in next major version (4.x)"),e("update",!1)}}),e("blob.primary",function(n){e("blob.builder",n())})},function(n){var t=n.send;t("blob.build",function(n,e){return e.add(Function),function n(e,d,l,f,h,v){if("boolean"==typeof e&&(e=""),function(n){return null===n}(e)&&(e=""),u(e)&&(e+=""),a(e))return h&&l.addUnsafe("textNode",f),{text:e,componentIdentity:v};var g=l.f(f);if(s(o(e),"view.build : vdom object is not a recognized type",g,e),i(e[0])){var y=b(e,3),m=y[0],w=y[1],O=void 0===w?{}:w,k=y[2],j=void 0===k?[]:k;s(c(O),"view.build : component's props is not an object",g,e,O),s(o(j),"view.build : component's children is not an array",g,e,j);var M=void 0,x=l;return h||(x=l.copy(),v={}),M=m(Object.assign({},O,{children:j}),function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];d.add(function(){t("sync",x.keys(),n(M.apply(void 0,r),d,x,f,!1,v),v),d.done()})}),s(i(M),"view.build : component should return a function",g,M),n(M(),d,x,f,!0,v)}var D=b(e,3),A=D[0],N=D[1],E=void 0===N?{}:N,S=D[2],C=void 0===S?[]:S;s(a(A),"view.build : tag property is not a string",g,e,A),s(c(E),"view.build : attributes is not an object",g,e,E),s(o(C),"view.build : children of vdom object is not an array",g,e,C);var I=/^ *?(\w+?) *?(?:#([-\w\d]+?))? *?((?:\.[-\w\d]+?)*?)? *?(?:\|\s*?([^\s][^]*?))? *?$/.exec(A);s(o(I),"view.build : tag property cannot be parsed",g,A);var $=b(I,5),T=$[1],F=$[2],J=$[3],U=$[4];r(F)&&!r(E.id)&&(E.id=F.trim()),(r(E.className)||r(J))&&(E.className=p(E.className,J).replace(/\./g," ").replace(/  +/g," ").trim()),r(U)&&(r(E.style)?(U=(U+";").replace(/;;$/g,";"),E.style=U+E.style):E.style=U);var q=f;"key"in E&&(q=E.key,s(u(q)||a(q),"view.build : invalid element key type",g,q),s((q=""+q).match(/^[\w\d-_]+$/g),"view.build : invalid character in element key",g,q),E.key=q),h?l.addUnsafe(A,q):l=l.add(A,q);for(var B={},R=[],z=0;z<C.length;++z){var H=C[z],L=""+z,P=n(H,d,l,L);P.attributes&&"key"in P.attributes&&(L=P.attributes.key),s(!B[L],"view.build : duplicate child key (note that text elements and elements with no key attribute are given their array index as key)",l.f(),L),R.push(L),B[L]=P}return{tagName:T,attributes:E,children:B,childOrder:R,componentIdentity:v}}(n,e,new h)})},function(n,t){var e=n.send,o=function n(e){if(r(e.text))return e.DOM=t.document.createTextNode(e.text),e;var o=t.document.createElement(e.tagName);Object.assign(o,e.attributes);for(var i=0;i<e.childOrder.length;++i){var a=e.childOrder[i],u=n(e.children[a]).DOM;o.appendChild(u)}return e.DOM=o,e},a=function n(t,e,a,u,c){if(r(e)){if(!r(a)){var d=u.DOM,l=e.DOM;return t.push(function(){d.removeChild(l)}),void delete u.children[c]}if(e.componentIdentity=a.componentIdentity,e.tagName!==a.tagName){var s=e.DOM,f=o(a),b=u.DOM,h=f.DOM;return t.push(function(){b.replaceChild(h,s)}),void Object.assign(e,{DOM:void 0,text:void 0,tagName:void 0,attributes:void 0,children:void 0,childOrder:void 0},f)}if(void 0===e.text){for(var v=function(n,t){for(var e=Object.keys(Object.assign({},n,t)),r=[],o=0;o<e.length;++o){var a=e[o],u=n[a],c=t[a];(i(u)||i(c))&&r.push(a),u!==c&&r.push(a)}return r}(e.attributes,a.attributes),p=function(n){var r=v[n],o=a.attributes[r];e.attributes[r]=o;var i=e.DOM;t.push(function(){i[r]=o})},g=0;g<v.length;++g)p(g);var y=e.childOrder.slice();e.childOrder=a.childOrder;var m=Object.keys(Object.assign({},e.children,a.children));for(g=0;g<m.length;++g){var w=m[g];e.children[w]?a.children[w]||y.splice(y.indexOf(w),1):y.push(w),n(t,e.children[w],a.children[w],e,w)}if(y.length){for(var O=function(n,t){for(var e=t.length,r=e/2,o=0,i=0,a=0;a<e;++a){for(var u=n.indexOf(t[a]),c=Math.min(e-u,e-a),d=1,l=1;l<c&&t[a+l]===n[u+l];++l)d+=1;if(d>o&&(o=d,i=a),o>=r)break}return{start:i,end:i+o-1}}(y,a.childOrder),k=O.start,j=O.end,M=a.childOrder.slice(0,k),x=function(n){var r=M[n],o=e.DOM,i=e.children[r].DOM;t.push(function(){o.insertBefore(i,o.firstChild)})},D=M.length-1;D>=0;--D)x(D);for(var A=a.childOrder.slice(j+1,1/0),N=function(n){var r=A[n],o=e.DOM,i=e.children[r].DOM;t.push(function(){o.appendChild(i)})},E=0;E<A.length;++E)N(E)}}else{var S=a.text;if(e.text!==S){var C=e.DOM;t.push(function(){C.nodeValue=S}),e.text=S}}}else{u.children[c]=o(a);var I=u.DOM,$=u.children[c].DOM;t.push(function(){I.appendChild($)})}};e("blob.draw",function(n,e){return s(d(n),"view.dom.draw : target is not a DOM node",n),o(e),t.requestAnimationFrame(function(){n.innerHTML="",n.appendChild(e.DOM)}),e}),e("blob.update",function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments[3],i=arguments[4];s(d(n),"view.dom.update : target is not a DOM node",n);for(var u={DOM:n,children:{root:o},childOrder:["root"]},c="root",l=o,f=0;f<r.length;++f)c=r[f],u=l,l=l.children[c];if(i){var b=l.componentIdentity===i;s(b,"view.dom.update : target of update has incorrect identity (this is generally caused by a component update being called on a component that no longer exists)")}var h=[];return a(h,l,e,u,c),t.requestAnimationFrame(function(){try{for(var n=0;n<h.length;++n)h[n]()}catch(n){console.error("view.dom.update : "+n)}}),o})},function(n,t){var e=n.on,r=n.send,o=void 0,u="",d=void 0,l=void 0,b=!1,h=t.location.pathname,v=null!==t.document.origin&&"null"!==t.document.origin;v||(h="");var p=f(),g=function(n){var t=u.replace(/([^\w])/g,"\\$1");return n.replace(new RegExp("^"+t),"")||""};t.onpopstate=function(){p.add(function(){h=g(t.location.pathname),l(o,h),p.done()})},e("blob.route",function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.path,e=n.handler;s(a(t),"on.blob.route : path is not a string",t),s(i(e),"on.blob.route : handler is not a function",t,e),s(i(d),"on.blob.route : register is not a function",d),p.add(function(){o=d(o,t,e),b||(b=!!l(o,h)),p.done()})}),e("blob.base",function(n){s(a(n),"on.blob.base : base url is not a string",n),p.add(function(){u=n,h=g(h),l(o,h),p.done()})}),e("blob.register",function(n){s(i(n),"on.blob.register : register is not a function",d),p.add(function(){d=n,p.done()})}),e("blob.fetch",function(n){s(i(n),"on.blob.fetch : fetch is not a function",l),p.add(function(){l=n,p.done()})}),e("redirect",function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(a(n),"on.redirect : path is not a string",n),s(c(e),"on.redirect : params is not an object",e),p.add(function(){h=n,v?t.history.pushState({},"",(u+h).replace(/^\/C\:/,"")):console.log("@okwolo : path changed to\n>>> "+h),l(o,h,e),p.done()})}),e("show",function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(a(n),"on.show : path is not a string",n),s(c(t),"on.show : params is not an object",t),p.add(function(){l(o,n,t),p.done()})}),r("blob.api",{redirect:function(n,t){return r("redirect",n,t)},show:function(n,t){return r("show",n,t)}})},function(n){(0,n.send)("blob.fetch",function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;return n.find(function(n){var o=n.pattern.exec(t);if(null!==o)return r=!0,o.shift(),n.keys.forEach(function(n,t){e[n.name]=o[t]}),n.handler(e),r}),r})},function(n){(0,n.send)("blob.register",function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],e=arguments[2],r=(t.match(m)||[]).map(function(n){return{name:n.replace(/^:/g,"")}}),o=void 0;return o="**"===t?/.*/g:function(n){var t=n.replace(/([^\w:])/g,"\\$1").replace(m,"([^/]*)");return new RegExp("^"+t+"(:?\\?.*)?$")}(t),n.push({keys:r,pattern:o,handler:e}),n})},function(n){n.on;var t=n.send;t("blob.primary",function(n,e){i(n)?t("blob.builder",n()):t("blob.route",{path:n,handler:function(n){t("blob.builder",e(n))}})})}];g.kit="lite",g.version="3.3.1",g.lite=g,this.okwolo=g}).call(this);